

pipeline {
  agent any
  options {
    buildDiscarder(logRotator(numToKeepStr: '5'))
  }
  tools {
    jfrog 'jfrog-cli'
}
  environment {
    CI = true
    ARTIFACTORY_ACCESS_TOKEN = credentials('artifactory-access-token')
    MAVEN_HOME = '/opt/apache-maven-3.8.6/bin'
  }
  stages {
    stage('Build') {
      steps {
        script {
          echo "${env.MAVEN_HOME}"
          echo "$MAVEN_HOME"
         sh '"$MAVEN_HOME/mvn" clean install -X'
          
        } //script
      } // step
    } // stage
    stage('Upload to Artifactory') {
      
      steps {
        jf 'rt ping'
        jf 'rt u target/demo-0.0.1-SNAPSHOT.jar java-web-app/ --target-props=project=maven'
        
      }
    }
  }
}
